---
output:
  md_document:
    variant: markdown_github
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, echo = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "README-"
)
```

# gmat
An R package for simulating positive definite matrices constrained by acyclic
directed and undirected graphs.

[![Build Status](https://travis-ci.org/irenecrsn/gmat.svg?branch=master)](https://travis-ci.org/irenecrsn/gmat)
[![CRAN downloads](http://cranlogs.r-pkg.org/badges/grand-total/gmat)](http://cran.r-project.org/package=gmat)
[![CRAN status](http://www.r-pkg.org/badges/version/gmat)](http://cran.r-project.org/package=gmat)

This package implements the methods described in the papers:

- Córdoba, I., Varando, G., Bielza, C. and Larrañaga, P. A partial orthogonalization method for simulating covariance and concentration graph matrices, Proceedings of Machine Learning Research (PGM 2018), vol. 72, pp. 61 - 72, 2018a.
- Córdoba I., Varando G., Bielza C., Larrañaga P. A fast
Metropolis-Hastings method for generating random correlation matrices. Lecture Notes in
Computer Science (IDEAL 2018), vol 11314, pp. 117-124, 2018b.
- Pourahmadi, M., Wang, X. Distribution of random correlation matrices:
Hyperspherical parameterization of the Cholesky factor, Statistics &
Probability Letters, 106:5-12, 2015.

### Simulation constrained to undirected graph models

It is governed by two main functions, `port` and `diagdom`, which take as input an undirected
graph structure `ug` and a sample size `N`, and generates `N`
covariance/concentration matrices subject to the zeros imposed by the undirected
graph structure `ug`.

The sample is generated by `port` with the method described in Córdoba et al.
(2018a). The classical diagonal dominance
method is the one used by function `diagdom`.

### Simulation constrained to acyclic digraph models

The function `rgbn_chol` implements the Metropolis-Hastings
algorithm described in the Córdoba et al. (2018b), while `rgbn_polar`
implements the polar parametrization method by Pouhramadi and Wang (2015). Both
methods are described for correlation matrices, but have been adapted for
allowing also an input acyclic digraph.

## Installation

The package is available on `CRAN`, to get the latest stable version use:
```{r cran-installation, eval = FALSE}
install.packages("gmat")
```
The current version on `CRAN` only includes the methods for undirected graph
models (Córdoba et al., 2018a).

Alternatively, using the R package `devtools` one may install the development version:
```{r gh-installation, eval = FALSE}
# install.packages("devtools")
devtools::install_github("irenecrsn/gmat")
```

The only R package required for `gmat` is `igraph`, which can also be installed
from CRAN.

## An example of use 

First, we generate a random graph with `3` nodes and density `0.25`, using the
`igraph` package. Then we generate, using our `gmat::port` function, `3` matrices
consistent with such random graphical structure.


```{r example}
ug <- igraph::sample_gnp(n = 3, p = 0.25)
matrices <- gmat::port(N = 3, ug = ug)
matrices
```

We apprieciate how the zero pattern is shared by all of the
simulated matrices. The return value is an array, and so the individual matrices
can be accessed as `matrices[, , n]`, where `n` is the index of the matrix we
want to retrieve from the sample, ranging from `1` to `N`.

