<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Sample random covariance/concentration graph matrices. — undirected graph matrix simulation • gmat </title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Sample random covariance/concentration graph matrices. — undirected graph matrix simulation" />

<meta property="og:description" content="Samples the covariance/concentration matrix corresponding to an
undirected graph by either partial orthogonalization or diagonal dominance." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">gmat </a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">0.1.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/irenecrsn/gmat">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Sample random covariance/concentration graph matrices.</h1>
    <small class="dont-index">Source: <a href='https://github.com/irenecrsn/gmat/blob/master/R/functions.R'><code>R/functions.R</code></a></small>
    <div class="hidden name"><code>rgmat.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>Samples the covariance/concentration matrix corresponding to an
undirected graph by either partial orthogonalization or diagonal dominance.</p>
    
    </div>

    <pre class="usage"><span class='fu'>port</span>(<span class='kw'>N</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>ug</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>p</span> <span class='kw'>=</span> <span class='fl'>5</span>, <span class='kw'>d</span> <span class='kw'>=</span> <span class='fl'>0.25</span>, <span class='kw'>rentries</span> <span class='kw'>=</span> <span class='no'>runif</span>,
  <span class='kw'>zapzeros</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)

<span class='fu'>diagdom</span>(<span class='kw'>N</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>ug</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>p</span> <span class='kw'>=</span> <span class='fl'>5</span>, <span class='kw'>d</span> <span class='kw'>=</span> <span class='fl'>0.25</span>, <span class='kw'>rentries</span> <span class='kw'>=</span> <span class='no'>runif</span>,
  <span class='kw'>k</span> <span class='kw'>=</span> <span class='kw'>NULL</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>N</th>
      <td><p>sample size</p></td>
    </tr>
    <tr>
      <th>ug</th>
      <td><p>the undirected graph</p></td>
    </tr>
    <tr>
      <th>p</th>
      <td><p>Matrix dimension (number of nodes in <code>ug</code> if provided)</p></td>
    </tr>
    <tr>
      <th>d</th>
      <td><p>number in <code>[0,1]</code>, the proportion of non-zero
entries (if <code>ug</code> is not provided)</p></td>
    </tr>
    <tr>
      <th>rentries</th>
      <td><p>the random number generator for the
non-zero entries (defaults to <code>runif</code>)</p></td>
    </tr>
    <tr>
      <th>zapzeros</th>
      <td><p>convert to zero extremely low entries</p></td>
    </tr>
    <tr>
      <th>k</th>
      <td><p>real number greater than <code>1</code>, the desired condition
number of the matrices in the resulting sample</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A three-dimensional array of length <code>p*p*N</code></p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Function <code>port</code> uses the method described in
Córdoba et al. (2018). In summary, it consists on generating a random
matrix <code>Q</code> and performing row-wise orthogonalization such that if <code>i</code> and <code>j</code>
are not adjacent in <code>ug</code>, then the rows corresponding to such indices are
orthogonalized, without violating previous orthogonalizations and without
introducing unwanted independences. The resulting matrix after the process
has finished is the cross product of <code>Q</code>.</p>
<p>We also provide an implementation of the most commonly used in the
literature <code>diagdom</code>. By contrast, this method produces a random matrix <code>M</code>
with zeros corresponding to missing edges in <code>ug</code>, and then enforces a
dominant diagonal to ensure positive definiteness. Matrices produced by
<code>diagdom</code> usually are better conditioned than those by <code>port</code>; however, they
typically suffer from small off-diagonal entries, which can compromise model
validation in Gaussian graphical models. This is avoided by <code>port</code>.</p>
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Córdoba, I., Varando, G., Bielza, C. and Larrañaga, P. A partial
orthogonalization method for simulation covariance and concentration graph
matrices. <em>Proceedings of Machine Learning Research</em> (PGM 2018), vol. 72, pp.
61 - 72, 2018.</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='co'># Generate a random undirected graph structure</span>
<span class='no'>ug</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>igraph</span><span class='kw ns'>::</span><span class='fu'><a href='http://www.rdocumentation.org/packages/igraph/topics/sample_gnp'>sample_gnp</a></span>(<span class='kw'>n</span> <span class='kw'>=</span> <span class='fl'>3</span>, <span class='kw'>p</span> <span class='kw'>=</span> <span class='fl'>0.25</span>)

<span class='co'># Generate 10 matrices complying with such random structure via </span>
<span class='co'># partial orthogonalization</span>
<span class='kw pkg'>gmat</span><span class='kw ns'>::</span><span class='fu'><a href='http://www.rdocumentation.org/packages/gmat/topics/rgmat'>port</a></span>(<span class='kw'>N</span> <span class='kw'>=</span> <span class='fl'>10</span>, <span class='kw'>ug</span> <span class='kw'>=</span> <span class='no'>ug</span>)</div><div class='output co'>#&gt; , , 1
#&gt; 
#&gt;           [,1]      [,2]      [,3]
#&gt; [1,] 0.4193935 0.0000000 0.7623402
#&gt; [2,] 0.0000000 0.0199438 0.0000000
#&gt; [3,] 0.7623402 0.0000000 1.5760805
#&gt; 
#&gt; , , 2
#&gt; 
#&gt;          [,1]      [,2]     [,3]
#&gt; [1,] 1.055225 0.0000000 1.092368
#&gt; [2,] 0.000000 0.8495949 0.000000
#&gt; [3,] 1.092368 0.0000000 1.130934
#&gt; 
#&gt; , , 3
#&gt; 
#&gt;          [,1]      [,2]     [,3]
#&gt; [1,] 1.806167 0.0000000 1.289307
#&gt; [2,] 0.000000 0.0246835 0.000000
#&gt; [3,] 1.289307 0.0000000 1.275753
#&gt; 
#&gt; , , 4
#&gt; 
#&gt;           [,1]      [,2]      [,3]
#&gt; [1,] 1.2210752 0.0000000 0.5056447
#&gt; [2,] 0.0000000 0.9897243 0.0000000
#&gt; [3,] 0.5056447 0.0000000 0.3290136
#&gt; 
#&gt; , , 5
#&gt; 
#&gt;           [,1]      [,2]      [,3]
#&gt; [1,] 0.1923741 0.0000000 0.2601706
#&gt; [2,] 0.0000000 0.9523532 0.0000000
#&gt; [3,] 0.2601706 0.0000000 0.3647553
#&gt; 
#&gt; , , 6
#&gt; 
#&gt;           [,1]      [,2]      [,3]
#&gt; [1,] 0.6114823 0.0000000 0.6128217
#&gt; [2,] 0.0000000 0.2432093 0.0000000
#&gt; [3,] 0.6128217 0.0000000 1.0140311
#&gt; 
#&gt; , , 7
#&gt; 
#&gt;           [,1]      [,2]     [,3]
#&gt; [1,] 0.9810017 0.0000000 1.049176
#&gt; [2,] 0.0000000 0.3243603 0.000000
#&gt; [3,] 1.0491759 0.0000000 1.175711
#&gt; 
#&gt; , , 8
#&gt; 
#&gt;           [,1]      [,2]      [,3]
#&gt; [1,] 0.1702705 0.0000000 0.2790246
#&gt; [2,] 0.0000000 0.2163994 0.0000000
#&gt; [3,] 0.2790246 0.0000000 0.5942012
#&gt; 
#&gt; , , 9
#&gt; 
#&gt;           [,1]      [,2]      [,3]
#&gt; [1,] 1.1092923 0.0000000 0.5371963
#&gt; [2,] 0.0000000 0.2288734 0.0000000
#&gt; [3,] 0.5371963 0.0000000 0.3197644
#&gt; 
#&gt; , , 10
#&gt; 
#&gt;           [,1]      [,2]      [,3]
#&gt; [1,] 0.2951385 0.0000000 0.6705835
#&gt; [2,] 0.0000000 0.4870976 0.0000000
#&gt; [3,] 0.6705835 0.0000000 1.5248435
#&gt; </div><div class='input'>
<span class='co'># Generate 10 matrices complying with such random structure via </span>
<span class='co'># diagonal dominance </span>
<span class='kw pkg'>gmat</span><span class='kw ns'>::</span><span class='fu'><a href='http://www.rdocumentation.org/packages/gmat/topics/rgmat'>diagdom</a></span>(<span class='kw'>N</span> <span class='kw'>=</span> <span class='fl'>10</span>, <span class='kw'>ug</span> <span class='kw'>=</span> <span class='no'>ug</span>)</div><div class='output co'>#&gt; , , 1
#&gt; 
#&gt;           [,1]    [,2]      [,3]
#&gt; [1,] 1.0794329 0.00000 0.2404612
#&gt; [2,] 0.0000000 1.69108 0.0000000
#&gt; [3,] 0.2404612 0.00000 0.7798505
#&gt; 
#&gt; , , 2
#&gt; 
#&gt;           [,1]      [,2]      [,3]
#&gt; [1,] 1.6300035 0.0000000 0.6388837
#&gt; [2,] 0.0000000 0.6917072 0.0000000
#&gt; [3,] 0.6388837 0.0000000 1.6154610
#&gt; 
#&gt; , , 3
#&gt; 
#&gt;           [,1]      [,2]      [,3]
#&gt; [1,] 1.2088045 0.0000000 0.5033951
#&gt; [2,] 0.0000000 0.1346397 0.0000000
#&gt; [3,] 0.5033951 0.0000000 0.6055200
#&gt; 
#&gt; , , 4
#&gt; 
#&gt;           [,1]       [,2]      [,3]
#&gt; [1,] 0.7479930 0.00000000 0.2505233
#&gt; [2,] 0.0000000 0.05403891 0.0000000
#&gt; [3,] 0.2505233 0.00000000 0.2554769
#&gt; 
#&gt; , , 5
#&gt; 
#&gt;           [,1]      [,2]      [,3]
#&gt; [1,] 2.8964896 0.0000000 0.9790338
#&gt; [2,] 0.0000000 0.2360891 0.0000000
#&gt; [3,] 0.9790338 0.0000000 1.9707031
#&gt; 
#&gt; , , 6
#&gt; 
#&gt;           [,1]       [,2]      [,3]
#&gt; [1,] 1.3764998 0.00000000 0.6565796
#&gt; [2,] 0.0000000 0.02739074 0.0000000
#&gt; [3,] 0.6565796 0.00000000 1.1441621
#&gt; 
#&gt; , , 7
#&gt; 
#&gt;           [,1]     [,2]      [,3]
#&gt; [1,] 0.4878214 0.000000 0.0898489
#&gt; [2,] 0.0000000 1.471459 0.0000000
#&gt; [3,] 0.0898489 0.000000 0.6013474
#&gt; 
#&gt; , , 8
#&gt; 
#&gt;           [,1]     [,2]      [,3]
#&gt; [1,] 2.0831136 0.000000 0.6305429
#&gt; [2,] 0.0000000 1.847922 0.0000000
#&gt; [3,] 0.6305429 0.000000 1.7351805
#&gt; 
#&gt; , , 9
#&gt; 
#&gt;           [,1]     [,2]      [,3]
#&gt; [1,] 1.2130326 0.000000 0.8767677
#&gt; [2,] 0.0000000 1.964381 0.0000000
#&gt; [3,] 0.8767677 0.000000 1.3799229
#&gt; 
#&gt; , , 10
#&gt; 
#&gt;           [,1]      [,2]      [,3]
#&gt; [1,] 1.3832442 0.0000000 0.9302815
#&gt; [2,] 0.0000000 0.8105404 0.0000000
#&gt; [3,] 0.9302815 0.0000000 2.1871819
#&gt; </div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#references">References</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Irene Córdoba, Gherardo Varando.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  

  </body>
</html>

